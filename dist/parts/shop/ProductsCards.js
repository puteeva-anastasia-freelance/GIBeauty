!function(){"use strict";class e{constructor(){this.pathToProductsImages="img/dist/products",this.wrapEl=document.querySelector(".shop__wrap")}setSameHeightAllElementsAndAddEventListeners(){this.setSameHeightAllElements(),this.addWidthResizeListener()}setSameHeightAllElements(){this.setSameHeightElements(".shop__img"),this.setSameHeightElements(".shop__subtitle"),this.setSameHeightElements(".shop__txt")}addWidthResizeListener(){window.addEventListener("resize",()=>{this.setSameHeightAllElements()})}formatNumberAndAddCurrencySign(e){return e.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")+" ₽"}getPriceProductMarkup(e){return`<span class="shop__price">${this.formatNumberAndAddCurrencySign(e.price)}</span>`}getPriceOldProductMarkup(e){return null!=e.priceOld?`<span class="shop__price-old">${this.formatNumberAndAddCurrencySign(e.priceOld)}</span>`:""}getOutOfStockMarkup(e){return 0==e.quantity?'<span class="shop__unavailable">Нет в наличии</span>':""}getProductMarkup(e){var t=this.getPriceProductMarkup(e),s=this.getPriceOldProductMarkup(e),r=this.getOutOfStockMarkup(e);return`<div class="shop__item" data-name="${e.name}">
					<a href="product-card.html#${e.id}" class="shop__link">	
						<picture>
							<source srcset="${this.pathToProductsImages}/${e.category}/${e.imageMiddle}" media="(min-width: 576px)" width="436" height="402">
							<source srcset="${this.pathToProductsImages}/${e.category}/${e.imageSmall}" media="(min-width: 0)" width="250" height="231">
							<img class="shop__img" src="${this.pathToProductsImages}/${e.category}/${e.imageSmall}" alt="Фотография товара" width="250" height="231">
						</picture>
						<h2 class="h4 shop__subtitle">${e.name}</h2>
					</a>
					<p class="shop__txt">${e.shortDescription}</p>
					${t}
					${s}
					${r}
				</div>`}insertProductsIntoPage(e,t){let s="";this.wrapEl.innerHTML="";for(var r of t)r.category==e&&(s+=this.getProductMarkup(r)),"discount"==e&&null!=r.priceOld&&(s+=this.getProductMarkup(r));this.wrapEl.insertAdjacentHTML("beforeend",s),this.setSameHeightAllElementsAndAddEventListeners()}changeStyleBtn(e){document.querySelector(".shop-category__btn.accent")&&document.querySelector(".shop-category__btn.accent").classList.remove("accent"),e.classList.add("accent")}changeTextBreadcrumbsAndTitle(e,t){var s=document.querySelectorAll(".breadcrumbs__link");s[s.length-1].textContent=e,s[s.length-1].href="shop.html#"+t,document.querySelector(".shop__title").textContent=e}changeStyleAndTextElements(e,t){this.changeStyleBtn(e),this.changeTextBreadcrumbsAndTitle(e.textContent,t)}findCategoryForRender(e,t){0==location.hash.length?(this.insertProductsIntoPage("sets",t),this.changeStyleAndTextElements(document.querySelector('[data-name="category-sets"]'),e)):null==document.querySelector(`[data-name="category-${e}"]`)?window.location.href="/":(this.insertProductsIntoPage(e,t),this.changeStyleAndTextElements(document.querySelector(`[data-name="category-${e}"]`),e))}renderCategoryProducts(t){var e=window.location.hash.substring(1);this.findCategoryForRender(e,t),window.addEventListener("hashchange",()=>{var e=window.location.hash.substring(1);this.findCategoryForRender(e,t)})}setSameHeightElements(e){var t=document.querySelectorAll(e);let s=t[0].getBoundingClientRect().top;var r=[],n=[];for(let e=0;e<t.length;e++)t[e].style.height="auto";for(let e=0;e<t.length;e++)if(s!=t[e].getBoundingClientRect().top){r.sort(function(e,t){return t-e});for(let e=0;e<n.length;e++)n[e].style.height="auto",n[e].style.height=r[0]+"px";s=t[e].getBoundingClientRect().top,r.length=n.length=0,e-=1}else r[r.length]=t[e].offsetHeight,n[n.length]=t[e];r.sort(function(e,t){return t-e});for(let e=0;e<n.length;e++)n[e].style.height="auto",n[e].style.height=r[0]+"px"}}window.addEventListener("load",()=>{(new e).renderCategoryProducts(products)})}();